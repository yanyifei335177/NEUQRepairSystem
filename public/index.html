<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>NEUQ电子设备维修</title>
<style>
body{font-family:Arial;margin:20px;}
h1{color:#333;}
input, select, textarea{margin:5px 0;width:300px;}
button{margin:5px;}
table{border-collapse:collapse;width:90%;}
th, td{border:1px solid #ccc;padding:5px;text-align:center;}
.status-pending{color:red;}
.status-confirmed{color:green;}
.status-rejected{color:orange;}
.status-completed{color:blue;}
</style>
</head>
<body>

<h1>NEUQ电子设备维修 - 客户端</h1>
<div>
<h2>提交申请</h2>
<label>姓名:<input type="text" id="name"></label><br>
<label>手机号:<input type="text" id="phone"></label><br>
<label>QQ邮箱:<input type="text" id="email"></label><br>
<label>需求:
<select id="service">
<option>电脑清灰</option>
<option>手机贴膜</option>
<option>小电子设备维修</option>
<option>其他</option>
</select></label><br>
<label>问题描述:<textarea id="description"></textarea></label><br>
<!-- 照片上传功能可在这里添加 -->
<label>预约时间:<input type="datetime-local" id="date"></label><br>
<label>地点:
<select id="location">
<option>工学馆</option>
<option>鹏四4331</option>
<option>校五5508</option>
</select></label><br>
<button onclick="submitRepair()">提交</button>
</div>

<hr>

<h2>我的维修申请</h2>
<table id="repairsTable">
<tr><th>ID</th><th>姓名</th><th>服务</th><th>状态</th><th>原因</th></tr>
</table>

<script>
function loadRepairs(){
  fetch("/api/repairs")
    .then(res=>res.json())
    .then(data=>{
      const table=document.getElementById("repairsTable");
      table.innerHTML='<tr><th>ID</th><th>姓名</th><th>服务</th><th>状态</th><th>原因</th></tr>';
      data.forEach(r=>{
        const tr=document.createElement("tr");
        tr.innerHTML=`<td>${r.id}</td>
        <td>${r.name}</td>
        <td>${r.service}</td>
        <td class="status-${r.status}">${r.status}</td>
        <td>${r.reason||""}</td>`;
        table.appendChild(tr);
      });
    });
}
function submitRepair(){
  const data={
    name:document.getElementById("name").value,
    phone:document.getElementById("phone").value,
    email:document.getElementById("email").value,
    service:document.getElementById("service").value,
    description:document.getElementById("description").value,
    date:document.getElementById("date").value,
    location:document.getElementById("location").value
  };
  fetch("/api/repairs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)})
  .then(res=>res.json()).then(r=>{alert("提交成功"); loadRepairs();});
}
loadRepairs();
</script>
</body>
</html>
